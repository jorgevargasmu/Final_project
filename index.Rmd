---
title: "Attending to Grammar Cues: L2 Learners' Processing of Grammatical Gender Agreement"
subtitle: "Eyetracking behavioral data"
author: "Jorge Vargas Mutizabal"
institute: "Rutgers - The State University of New Jersey"
date: "(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    css: ["hygge", "rutgers", "rutgers-fonts"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

# Background 

The phrase structure of Spanish can have grammatical gender cues, which allow speakers to predict the gender of upcoming lexical units. 

##Phrase conditions:
1. La casa (determiner and noun)
2. Su casa (noun)
3. La mente (determiner)
4. Su mente ( - )

## La casa **linda**

---

#Research questions:
## - How do low proficiency Spanish L2 learners process grammatical gender agreement with adjectives in the different phrase conditions? 

## - Do reaction times and accuracy vary with the phrase conditions?

---
#Analysis
Preparation: Load library 
```{r fig.height=3, fig.width=3}
library(tidyverse)
library(dplyr)
library(stringr)
library(here)
library(lmerTest)
library(lme4)
library(ggpubr)
library(ggplot2)
```
---
##Data was uploaded and inspected to prepare tidying 
```{r fig.height=4, fig.width=4}
data <- read.csv(here("Behavioral_nat.csv"))
```

##Inspected the data
```{r}
glimpse(data)
```
---
#Tidying
- To get the conditions as C1, C2, C3, C4, what came before the _ was removed. 
```{r}
data_tidy <- data|>
  mutate(Condition = sub(".*_", "", Condition))
```

- Glimpse again  
```{r}
glimpse(data_tidy)
```
---
- Filter to analyze participants with ID starting with A and creating a new data frame
```{r fig.height=2, fig.width=2}
data_tidy_A <- data_tidy |>
  filter(str_starts(ID, "A"))
```
##Calculate mean accuracy per condition
```{r}
##Mean Accuracy
Table_Acc <- data_tidy_A|>
  group_by(Condition)|>
  summarise(mean_accuracy = mean(Accuracy))
knitr::kable(Table_Acc)
```
---
#Accuracy Model: Logistic regression
##Probability of selecting a correct reponse
## Accuracy ~ 1 + Condition + (1 | ID) + (1 | Item)
```{r}
Model_Acc <- glmer(
  formula = Accuracy ~ 1 + Condition + (1 | ID ) + (1 | Item),
  data = data_tidy_A, 
  family = binomial(link = "logit")
)
    
```
##Model summary (next slide)
---
```{r}
summary(Model_Acc)
```
---
##Accuracy plot 
```{r fig.height=5, fig.width=5}
data_tidy_A |>
  ggplot(aes(x = Condition, y = Accuracy, fill = Condition)) +
  stat_summary(fun = mean, geom = "col") +
  labs(x = "Phrase condition", y = "Mean Accuracy", title = "Accuracy per phrase condition") +
  theme_minimal()

```
---
##Calculate mean RT per condition
```{r}
Table_RT <- data_tidy_A|>
  group_by(Condition)|>
  summarise(mean_RT = mean(RT))

knitr::kable(Table_RT)
```

---
#Model Reaction Time
## RT ~ 1 + Condition + (1 | ID) + (1 | Item) 

```{r}
Model_RT <- lmer(RT ~ 1 + Condition + (1 | ID) + (1 | Item), data = data_tidy_A)
```
Summary (next slide)
---
```{r echo=FALSE}
summary(Model_RT)
```
---
##Reaction times plot 

```{r echo=FALSE, fig.height=5, fig.width=5}
data_tidy_A |>
  ggplot(aes(x = Condition, y = RT, fill = Condition)) +
  geom_boxplot() +
  labs(x = "Phrase condition", y = "RT", title = "Reaction by phrase condition") +
  theme_minimal()

```
---
####### The same but for B

- Filter to analyze participants with ID starting with A and creating a new data frame
```{r fig.height=2, fig.width=2}
data_tidy_B <- data_tidy |>
  filter(str_starts(ID, "B"))
```

```{r}
##Mean Accuracy
Table_Acc_B <- data_tidy_B|>
  group_by(Condition)|>
  summarise(mean_accuracy = mean(Accuracy))
knitr::kable(Table_Acc)
```
---
#Accuracy Model: Logistic regression
##Probability of selecting a correct reponse
## Accuracy ~ 1 + Condition + (1 | ID) + (1 | Item)
```{r}
Model_Acc_B <- glmer(
  formula = Accuracy ~ 1 + Condition + (1 | ID ) + (1 | Item),
  data = data_tidy_A, 
  family = binomial(link = "logit")
)
    
```
##Model summary (next slide)
---
```{r}
summary(Model_Acc_B)
```
---
##Accuracy plot 
```{r fig.height=5, fig.width=5}
data_tidy_B |>
  ggplot(aes(x = Condition, y = Accuracy, fill = Condition)) +
  stat_summary(fun = mean, geom = "col") +
  labs(x = "Phrase condition", y = "Mean Accuracy", title = "Accuracy per phrase condition") +
  theme_minimal()

```
---
##Calculate mean RT per condition
```{r}
Table_RT_B <- data_tidy_B|>
  group_by(Condition)|>
  summarise(mean_RT = mean(RT))

knitr::kable(Table_RT)
```

---
#Model Reaction Time
## RT ~ 1 + Condition + (1 | ID) + (1 | Item) 

```{r}
Model_RT_B <- lmer(RT ~ 1 + Condition + (1 | ID) + (1 | Item), data = data_tidy_B)
```
Summary (next slide)
---
```{r echo=FALSE}
summary(Model_RT_B)
```
---
##Reaction times plot 

```{r echo=FALSE, fig.height=5, fig.width=5}
data_tidy_B |>
  ggplot(aes(x = Condition, y = RT, fill = Condition)) +
  geom_boxplot() +
  labs(x = "Phrase condition", y = "RT", title = "Reaction by phrase condition") +
  theme_minimal()

```

---
##New models

```{r}
model_acc_AB <- glmer(Accuracy ~ ID * Condition + (1 | ID) + (1 | Item), data = data_tidy_A, family = binomial)

summary(model_acc_AB)

```

